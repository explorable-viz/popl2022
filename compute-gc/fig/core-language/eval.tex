\begin{figure}[H]
\flushleft \shadebox{$\rho, e \eval v, \phi$}
\begin{smathpar}
   \inferrule*[
      lab={\ruleName{$\eval$-var}},
      right={$\envLookup{\rho}{x}{v}$}
   ]
   {
      \strut
   }
   {
      \rho, x
      \eval
      v,
      \lambda_{\hole} u.
      (\envLookupBwd{\hole_\rho}{}{\bind{x}{u}}, x)
   }
   %
   \and
   %
   \inferrule*[lab={\ruleName{$\eval$-lambda}}]
   {
      \strut
   }
   {
      \rho, \exLambda{x}{e} \eval
      \exClosure{\rho}{x}{e},
      \lambda_\hole\{\exClosure{\rho'}{x}{e'} \mapsto (\rho', \exLambda{x}{e'})\}
   }
   %
   \and
   %
   \inferrule*[
      lab={\ruleName{$\eval$-int}}
   ]
   {
      \strut
   }
   {
      \rho, \exInt{n}
      \eval
      \exInt{n},
      \lambda_\hole u.(\hole_{\rho}, \exInt{n})
   }
   %
   \and
   %
   \inferrule*[
      lab={\ruleName{$\eval$-nil}}
   ]
   {
      \strut
   }
   {
      \rho, \exNil \eval
      \exNil,
      \lambda_\hole \{\exNil \mapsto (\hole_{\rho}, \exNil)\}
   }
   %
   \and
   %
   \inferrule*[
      lab={\ruleName{$\eval$-cons}}
   ]
   {
      \rho, e \eval v, \phi
      \\
      \rho, e' \eval v', \psi
   }
   {
      \rho, \exCons{e}{e'}
      \eval
      \exCons{v}{v'},
      \lambda_\hole \{\exCons{u}{u'} \mapsto (\rho_1 \join \rho_2, \exCons{e_1}{e_2})
      \text{ where }
      (\rho_1, e_1) = \phi(u); (\rho_2, e_2) = \phi(u')\}
   }
   %
   \and
   %
   \inferrule*[
      lab={\ruleName{$\eval$-match-nil}}
   ]
   {
      \rho, e \eval \exNil, \phi
      \\
      \rho, e_1 \eval v, \psi
   }
   {
      \rho, \exMatchList{e}{e_1}{x}{y}{e_2}
      \eval
      v,
      \lambda v'.(\rho_1 \join \rho_2, \exMatchList{e'}{e_1'}{x}{y}{\hole})
      \\
      \text{ where } (\rho_1, e') = \phi(\exNil); (\rho_2, e_1') = \psi(v')
   }
   %
   \and
   %
   \inferrule*[
      lab={\ruleName{$\eval$-match-cons}}
   ]
   {
      \rho, e \eval \exCons{v_1}{v_2}, \phi
      \\
      \rho \concat \bind{x}{v_1} \concat \bind{y}{v_2}, e_2 \eval v, \psi
   }
   {
      \rho, \exMatchList{e}{e_1}{x}{y}{e_2}
      \eval
      v,
      \lambda v'.(\rho_1 \join \rho_2, \exMatchList{e'}{\hole}{x}{y}{e_2'})
      \\
      \text{ where }
      (\rho_2 \concat \bind{x}{v_1'} \concat \bind{y}{v_2'}, e_2') = \psi(v');
      (\rho_1, e') = \phi(\exCons{v_1'}{v_2'})
   }
   %
   \and
   %
   \inferrule*[
      lab={\ruleName{$\eval$-apply}}
   ]
   {
      \rho, e \eval \exClosure{\rho_1}{x}{e^\twoPrime}, \phi
      \\
      \rho, e' \eval v, \phi'
      \\
      \rho \concat \bind{x}{v} \eval v', \psi
   }
   {
      \rho, \exApp{e}{e'}
      \eval
      v',
      \lambda v^\twoPrime.(\rho_1 \join \rho_2, \exApp{e_1}{e_2})
      \text{ where }
      (\rho^\dagger \concat \bind{x}{v^\dagger}, e^\dagger) = \psi(v^\twoPrime);
      (\rho_2, e_2) = \phi'(v^\dagger);
      (\rho_1, e_1) = \phi(\exClosure{\rho^\dagger}{x}{e^\dagger})
   }
\end{smathpar}

\caption{Evaluation}
\end{figure}
