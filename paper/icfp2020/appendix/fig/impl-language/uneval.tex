\begin{figure}
\flushleft \shadebox{$\explVal{T}{u} \uneval \rho, e$}
\begin{smathpar}
   \inferrule*[left={\ruleName{$\uneval$-var}}]
   {
      \strut
   }
   {
      \explVal{{\trVarTwo{x}{\rho}}}{\annot{v}{\alpha}}
      \uneval
      \envExtend{\sub{\bot}{\rho}}{x}{\annot{v}{\alpha}},
      \annot{\exVar{x}}{\alpha}
   }
   %
   \and
   %
   \inferrule*[left={\ruleName{$\uneval$-const}}]
   {
      \strut
   }
   {
      \explVal{\sub{\trEmpty}{\rho}}{\annot{\exConst{k}}{\alpha}}
      \uneval
      \sub{\bot}{\rho},
      \annot{\exConst{k}}{\alpha}
   }
   %
   \and
   %
   \inferrule*[left={\ruleName{$\uneval$-fun}}]
   {
      \strut
   }
   {
      \explVal{\sub{\trEmpty}{\rho}}{\annot{\exClosureNew{\rho'}{\seqEmpty}{\exFun{\sigma}}}{\alpha}}
      \uneval
      \rho',
      \annot{(\exFun{\sigma})}{\alpha}
   }
   %
   \and
   %
   \inferrule*[left={\ruleName{$\uneval$-app}}]
   {
      \explVal{U}{\annot{v}{\alpha}} \uneval {\rho_1}' \concat \rho_2 \concat \rho_3, e^\twoPrime
      \\
      \rho_3, \matchPlug{\xi}{e^\twoPrime}, \alpha \unlookupR{} u, \sigma
      \\
      \explVal{T'}{u} \uneval \rho, e'
      \\
      \rho_2 \uncloseDefs {\rho_1}^\twoPrime, \delta'
      \\
      \explVal{T}{\annot{\exClosureNew{{\rho_1}' \vee {\rho_1}^\twoPrime}{\delta'}{\exFun{\sigma}}}{\alpha}}
      \uneval
      \rho', e
   }
   {
      \explVal
         {\trApp{T}{T'}{\matchPlug{\xi}{U}}}
         {\annot{v}{\alpha}}
      \uneval
      \rho \vee \rho',
      \annot{(\exApp{e}{e'})}{\alpha}
   }
   %
   \and
   %
   \inferrule*[
      left={\ruleName{$\uneval$-app-unary}}
   ]
   {
      \explVal{T'}{\annot{c}{\alpha}} \uneval \rho', e'
      \\
      \explVal{T}{\annot{\phi}{\alpha}} \uneval \rho, e
   }
   {
      \explVal
         {\trApp{(\explVal{T}{\phi})}{(\explVal{T'}{c})}{\sub{\trEmpty}{\envEmpty}}}
         {\annot{v}{\alpha}}
      \uneval
      \rho \vee \rho',
      \annot{(\exApp{e}{e'})}{\alpha}
   }
   %
   \and
   %
   \inferrule*[
      left={\ruleName{$\uneval$-app-binary}}
   ]
   {
      \explVal{T'}{\annot{c'}{\alpha}} \uneval \rho', e'
      \\
      \explVal{T}{\annot{c}{\alpha}} \uneval \rho, e
   }
   {
      \explVal
         {\trPrimApp{(\explVal{T}{c})}{\primOp}{(\explVal{T'}{c'})}}
         {\annot{v}{\alpha}}
      \uneval
      \rho \vee \rho',
      \annot{(\exPrimApp{e}{\annot{\primOp}{\alpha}}{e'})}{\alpha}
   }
   %
   \and
   %
   \inferrule*[left={\ruleName{$\uneval$-constr}}]
   {
      \vec{\explVal{T}{u}} \uneval \rho', \vec{e}
   }
   {
      \explVal{\sub{\trEmpty}{\rho}}{\annot{\exConstr{d}{\vec{\explVal{T}{u}}}}{\alpha}}
      \uneval
      \rho',
      \annot{\exConstr{d}{\vec{e}}}{\alpha}
   }
   %
   \and
   %
   \inferrule*[left={\ruleName{$\uneval$-match}}]
   {
      \explVal{T'}{\annot{v}{\alpha}} \uneval \rho' \concat \rho_1, e'
      \\
      \rho_1, \matchPlug{\xi}{e'}, \alpha \unlookupR{} u, \sigma
      \\
      \explVal{T}{u} \uneval \rho, e
   }
   {
      \explVal{\trMatch{T}{\matchPlug{\xi}{T'}}}{\annot{v}{\alpha}}
      \uneval
      \rho \vee \rho',
      \annot{(\exMatch{e}{\sigma})}{\alpha}
   }
   %
   \and
   %
   \inferrule*[left={\ruleName{$\uneval$-let}}]
   {
      \explVal{U}{\annot{v}{\alpha}} \uneval \envExtend{\rho}{x}{u'}, e'
      \\
      \explVal{T}{u'} \uneval \rho', e
   }
   {
      \explVal{\trLet{x}{\explVal{T}{u}}{U}}{\annot{v}{\alpha}}
      \uneval
      \rho \vee \rho', \annot{(\exLet{x}{e}{e'})}{\alpha}
   }
   %
   \and
   %
   \inferrule*[left={\ruleName{$\uneval$-letrec}}]
   {
      \explVal{T}{\annot{v}{\alpha}} \uneval \rho \concat \rho_1, e
      \\
      \rho_1 \uncloseDefs \rho', \delta'
   }
   {
      \explVal{\trLetrec{\delta}{T}}{\annot{v}{\alpha}}
      \uneval
      \rho \vee \rho', \annot{(\exLetrec{\delta'}{e})}{\alpha}
   }
\end{smathpar}
\\
\flushleft \shadebox{$\vec{\explVal{T}{u}} \uneval \rho, \vec{e}$}
\begin{smathpar}
   \inferrule*
   {
      \strut
   }
   {
      \annot{\seqEmpty}{\rho}
      \uneval
      \sub{\bot}{\rho},
      \exUnit
   }
   \and
   %
   \inferrule*
   {
      \vec{\explVal{T}{u}} \uneval \rho_1, \vec{e}
      \\
      \explVal{T}{u} \uneval \rho_1, e
   }
   {
      (\explVal{T}{u}) \concat (\vec{\explVal{T}{u}})
      \uneval
      \rho_1 \vee \rho_2,
      e \concat \vec{e}
   }
\end{smathpar}
\caption{Reverse evaluation for terms and term sequences}
\end{figure}
