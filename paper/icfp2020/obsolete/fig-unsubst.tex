\begin{figure*}
\fbox{$\unsubst{x}{e}$}
\begin{align*}
\unsubst{x}{\bot}
&=
(\bot,\bot)
\\
\unsubst{x}{\exVal{y}{v}}
&=
\begin{cases}
(v,x)
&
\text{if }y = x
\\
(\bot,\exVal{y}{v})
&
\text{otherwise}
\end{cases}
\\
\unsubst{x}{\exUnit}
&=
(\bot,\exUnit)
\\
\unsubst{x}{\exInl{e}}
&=
(v,\exInl{e'})\text{, where }\unsubst{x}{e} = (v,e')
\\
\unsubst{x}{\exCase{e}{x_1}{e_1}{x_2}{e_2}}
&=
\begin{cases}
(v \join v_1 \join v_2, \exCase{e'}{x_1}{{e_1}'}{x_2}{{e_2}'})
\\
\begin{aligned}
\text{where }
&
(v,e')
=
\unsubst{x}{e}
\\
&
(v_1,{e_1}')
=
\begin{cases}
\unsubst{x}{e_1}
&
\text{if }x \neq x_1
\\
(\bot,e_1)
&
\text{otherwise}
\end{cases}
\\
&
(v_2,{e_2}')
=
\begin{cases}
\unsubst{x}{e_2}
&
\text{if }x \neq x_2
\\
(\bot,e_2)
&
\text{otherwise}
\end{cases}
\end{aligned}
\end{cases}
\\
\unsubst{x}{\exPair{e_1}{e_2}}
&=
\begin{cases}
(v_1 \join v_2, \exPair{{e_1}'}{{e_2}'})
\\
\begin{aligned}
\text{where }
&
(v_1, {e_1}') = \unsubst{x}{e_1}
\\
&
(v_2, {e_2}') = \unsubst{x}{e_2}
\end{aligned}
\end{cases}
\\
\unsubst{x}{\exFst{e}}
&=
(v, \exFst{e'})\text{, where }\unsubst{x}{e} = (v,e')
\\
\unsubst{x}{\exRecFun{f}{y}{e}}
&=
\begin{cases}
(\bot,\exRecFun{f}{y}{e})
&
\text{if }x \in \{y, f\}
\\
(v,\exRecFun{f}{y}{e'})\text{, where }\unsubst{x}{e} = (v,e')
&
\text{otherwise}
\end{cases}
\\
\unsubst{x}{\exApp{e_1}{e_2}}
&=
\begin{cases}
(v_1 \join v_2, \exApp{{e_1}'}{{e_2}'})
\\
\begin{aligned}
\text{where }
&
(v_1, {e_1}') = \unsubst{x}{e_1}
\\
&
(v_2, {e_2}') = \unsubst{x}{e_2}
\end{aligned}
\end{cases}
\\
\unsubst{x}{\exRoll{e}}
&=
(v,\exRoll{e'})\text{, where }\unsubst{x}{e} = (v,e')
\\
\unsubst{x}{\exUnroll{e}}
&=
(v,\exUnroll{e'})\text{, where }\unsubst{x}{e} = (v,e')
\end{align*}
\caption{Unsubstitution of variable from closed term}
\end{figure*}
