\begin{figure}[H]
\begingroup
\renewcommand*{\arraystretch}{1.2}
\begin{syntaxfig}
\mbox{Evaluation context}
&
\evalCxt{\Ev}{\sigma}
&
::=
&
\ldots
\\
&&&
\exLet{x}{\evalCxt{\Ev}{\sigma}}{\plug{\evalCxt{\Ev'}{\sigma'}}{\exVar{x}}{\sigma}}
&
\text{shared variable}
\end{syntaxfig}
\endgroup

\noindent \shadebox{$e \reduceNeed{\sigma} e'$}
{\small
\begin{align*}
e
&
\quad \reduceNeed{\trieVarNoRHS{x}} \quad
\exThunkVar{x}{e}
\\
\exApp{\exFun{\sigma}}{\;v}
&
\quad \reduceNeed{\tau} \quad
\kw{let}\;{\envFor{v}}\;\kw{in}\;{\lookup{\sigma}{v}}
&
(v \in \Dom \sigma)
\\
\exLet{x}{v}{\plug{\evalCxt{\Ev}{\sigma'}}{\exApp{}{\exVar{x}}}{\sigma}}
&
\quad \reduceNeed{\tau} \quad
\exLet{x}{v}{\plug{\evalCxt{\Ev}{\sigma'}}{v}{\sigma}}
&
(v \in \Dom \sigma)
\end{align*}
}
\caption{Small-step call-by-need}
\label{fig:reduce:call-by-need}
\end{figure}
