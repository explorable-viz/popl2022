\begin{figure}[H]
\flushleft \shadebox{$v, T \bwdSlice \rho, e, \alpha$}
\begin{smathpar}
   \inferrule*[
      lab={\ruleName{$\bwdSlice$-var}}
   ]
   {
      \envLookupBwd{\rho}{\Gamma}{\bind{x}{v}}
   }
   {
      v, \trVar{x}{\Gamma} \bwdSlice \rho, \exVar{x}, \FF
   }
   %
   \and
   %
   \inferrule*[
      lab={\ruleName{$\bwdSlice$-op}}
   ]
   {
      v \geq \phi
      \\
      \envLookupBwd{\rho}{\Gamma}{\bind{\primOp}{\phi}}
   }
   {
      v, \trOp{\primOp}{\Gamma}
      \bwdSlice
      \rho, \exOp{\primOp}, \FF
   }
   %
   \and
   %
   \inferrule*[
      lab={\ruleName{$\bwdSlice$-lambda}}
   ]
   {
      v \geq \exClosure{\rho}{\seqEmpty}{\sigma}
   }
   {
      v, \trLambda{\sigma'}
      \bwdSlice
      \rho, \exLambda{\sigma}, \FF
   }
   %
   \and
   %
   \inferrule*[
      lab={\ruleName{$\bwdSlice$-int}}
   ]
   {
      v \geq \annInt{n}{\alpha}
   }
   {
      v, \trInt{n}{\Gamma} \bwdSlice \hole_{\Gamma}, \annInt{n}{\alpha}, \alpha
   }
   %
   \and
   %
   \inferrule*[
      lab={\ruleName{$\bwdSlice$-nil}}
   ]
   {
      v \geq \annNil{\alpha}
   }
   {
      v, \trNil{\Gamma} \bwdSlice \hole_{\Gamma}, \annNil{\alpha}, \alpha
   }
   %
   \and
   %
   \inferrule*[
      lab={\ruleName{$\bwdSlice$-cons}}
   ]
   {
      v \geq \annCons{v_1}{v_2}{\beta}
      \\
      v_1, T \bwdSlice \rho, e_1, \alpha
      \\
      v_2, U \bwdSlice \rho', e_2, \alpha'
   }
   {
      v, \trCons{T}{U}
      \bwdSlice
      \rho \join \rho', \annCons{e_1}{e_2}{\beta}, \beta \join \alpha \join \alpha'
   }
   %
   \and
   %
   \inferrule*[
      lab={\ruleName{$\bwdSlice$-matrix}}
   ]
   {
      v \geq \annMatrix{u_{i,j}}{i}{j}{(\annInt{\ihat}{\beta},\annInt{\jhat}{\beta})}{\beta^\twoPrime}
      \\
      u_{i,j}, U_{i,j}
      \bwdSlice
      \rho_{i,j} \concat \bind{x}{i_{\gamma_{i,j}}} \concat \bind{y}{j_{\gamma'_{i,j}}}, e_{i,j}, \alpha_{i,j}
      \quad
      (\forall (i,j) \numleq (\ihat,\jhat))
      \\
      \annot{\exPair{\annInt{\ihat}{\bigjoin\gamma \join \beta}}
            {\annInt{\jhat}{\bigjoin\gamma' \join \beta'}}}{\FF},
      T
      \bwdSlice
      \rho', e', \alpha'
   }
   {
      v,
      \trMatrix{U_{i,j}}{x}{y}{i}{j}{T}{\ihat,\jhat}
      \bwdSlice
      (\bigjoin\rho) \join \rho',
      \annMatrix{\bigjoin e}{x}{y}{e'}{\beta^\twoPrime},
      \beta^\twoPrime \join (\bigjoin{\alpha}) \join \alpha'
   }
   %
   \and
   %
   \inferrule*[
      lab={\ruleName{$\bwdSlice$-matrix-lookup}}
   ]
   {
      \mapUpdate{\annMatrix{\hole}{i}{j}{(\annInt{\ihat}{\FF},\annInt{\jhat}{\FF})}{\FF}}{\exPair{i}{j}}{v}, T
      \bwdSlice
      \rho, e, \alpha
      \\
      \annPair{\annInt{i}{\FF}}{\annInt{j}{\FF}}{\FF}, U \bwdSlice \rho', e', \alpha'
   }
   {
       v, \trMatrixAccess{T}{\ihat,\jhat}{U}{i,j}
       \bwdSlice
       \rho \join \rho', \exMatrixAccess{e}{e'}, \alpha \join \alpha'
   }
   %
   \and
   %
   \inferrule*[
      lab={\ruleName{$\bwdSlice$-matrix-dims}}
   ]
   {
      v \geq \annPair{\annInt{\ihat}{\beta}}{\annInt{\jhat}{\beta'}}{\gamma}
      \\
      \annMatrix{\hole}{i}{j}{(\annInt{\ihat}{\beta},\annInt{\jhat}{\beta'})}{\gamma}, T \bwdSlice \rho, e, \alpha
   }
   {
      v, \trMatrixDims{T}{\ihat,\jhat}
      \bwdSlice
      \rho, \exMatrixDims{e}, \alpha
   }
   %
   \and
   %
   \inferrule*[
      lab={\ruleName{$\bwdSlice$-apply}}
   ]
   {
      v, T' \bwdSlice \rho_1 \concat \rho_2 \concat \rho_3, e, \beta
      \\
      \rho_3, e, \beta, w, \matchBwd v', \sigma
      \\
      v', U \bwdSlice \rho, e_2, \alpha
      \\
      \rho_2 \closeDefsBwd \rho_1', h
      \\
      \exClosureRec{\Gamma}{\rho_1 \join \rho_1'}{h}{\sigma}, T
      \bwdSlice
      \rho', e_1, \alpha'
   }
   {
      v, \trApp{T}{U}{\matchPlug{w}{T'}}
      \bwdSlice
      \rho \join \rho', \exApp{e_1}{e_2}, \alpha \join \alpha'
   }
   %
   \and
   %
   \inferrule*[
      lab={\ruleName{$\bwdSlice$-apply-prim}}
   ]
   {
      v \geq \annInt{n}{\beta}
      \\
      \phi, T \bwdSlice \rho, e_1, \alpha
      \\
      \annInt{m}{\beta}, U \bwdSlice \rho', e_2, \alpha'
   }
   {
      v, \trAppPrim{T}{\phi}{U}{\exInt{m}}
      \bwdSlice
      \rho \join \rho', \exApp{e_1}{e_2}, \alpha \join \alpha'
   }
   %
   \and
   %
   \inferrule*[
      lab={\ruleName{$\bwdSlice$-binary-apply}},
      right={$\vdash \rho_1: \Gamma$}
   ]
   {
      v \geq \annInt{n}{\beta}
      \\
      \annInt{m}{\beta}, T \bwdSlice \rho_1, e_1, \alpha
      \\
      \envLookupBwd{\rho_3}{\Gamma}{\bind{\primOp}{\phi}}
      \\
      \annInt{m'}{\beta}, U \bwdSlice \rho_2, e_2, \alpha'
   }
   {
      v, \trBinaryApp{T}{m}{\primOp}{\phi}{U}{m'}
      \bwdSlice
      \rho_1 \join \rho_2 \join \rho_3, \exBinaryApp{e_1}{\primOp}{e_2}, \alpha \join \alpha'
   }
   %
   \and
   %
   \inferrule*[
      lab={\ruleName{$\bwdSlice$-let-rec}}
   ]
   {
      v, T \bwdSlice \rho \concat \rho_1, e, \alpha
      \\
      \rho_1 \closeDefsBwd \rho', h'
   }
   {
      v, \trLetRecMutual{h}{T} \bwdSlice \rho \join \rho', \exLetRecMutual{h'}{e}, \alpha
   }
\end{smathpar}

\vspace{5pt}
\flushleft\shadebox{$\rho \closeDefsBwd \rho', h$}
\begin{salign}
   \seqRange{x_1: \exClosure{\rho_1}{h_1}{\sigma_1}}{x_n: \exClosure{\rho_n}{h_n}{\sigma_n}}
   &\closeDefsFwd
   \bigjoin\rho,
   (\seqRange{x_1: \sigma_1}{x_n: \sigma_n}) \join (\bigjoin h)
\end{salign}
\caption{Evaluation: backward slicing (Boolean and pair cases omitted)}
\end{figure}
