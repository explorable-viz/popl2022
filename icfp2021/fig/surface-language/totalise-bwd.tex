\begin{figure}[H]
\flushleft \shadebox{$\untotalise{\kappa}{\pi}{\kappa'}{\alpha}$}
\begin{smathpar}
\inferrule*[
   lab={\ruleName{empty}}
]
{
   \strut
}
{
   \untotalise{\kappa}{\seqEmpty}{\kappa}{\FF}
}
\and
%
\inferrule*[
   lab={\ruleName{var}}
]
{
   \untotalise{\kappa}{\vec{p}}{\kappa'}{\alpha}
}
{
   \untotalise{\elimVar{x}{\kappa}}{x \concat \vec{p}}{\elimVar{x}{\kappa'}}{\alpha}
}
%
\and
%
\inferrule*[
   lab={\ruleName{true}}
]
{
   \untotalise{\kappa_1}{\vec{p}}{\kappa_1'}{\beta}
}
{
   \untotalise{\elimBool{\kappa_1}{\annot{\exNil}{\alpha}}}
              {\pattTrue \concat \vec{p}}
              {\elimBoolTrue{\kappa_1'}}
              {\alpha \join \beta}
}
%
\and
%
\inferrule*[
   lab={\ruleName{false}}
]
{
   \untotalise{\kappa_2}{\vec{p}}{\kappa_2'}{\beta}
}
{
   \untotalise{\elimBool{\annot{\exNil}{\alpha}}{\kappa_2}}
              {\pattFalse \concat \vec{p}}
              {\elimBoolFalse{\kappa_2'}}
              {\alpha \join \beta}
}
%
\and
%
\inferrule*[
   lab={\ruleName{prod}}
]
{
   \untotalise{\sigma}{(p \concat p' \concat \vec{p})}{\sigma'}{\beta}
}
{
   \untotalise{(\elimProd{\sigma})}{\pattPair{p}{p'} \concat \vec{p}}{(\elimProd{\sigma'})}{\beta}
}
%
\and
%
\inferrule*[
   lab={\ruleName{nil}}
]
{
   \untotalise{\kappa}{\vec{p}}{\kappa'}{\beta}
}
{
   \untotalise{\elimList{\branchNil{\kappa}}{\branchCons{\elimVar{x}{\elimVar{y}{\annot{\exNil}{\alpha}}}}}}
              {(\pattNil \concat \vec{p})}
              {\elimNil{\kappa'}}
              {\alpha \join \beta}
}
%
\and
%
\inferrule*[
   lab={\ruleName{cons}}
]
{
   \untotalise{\sigma}{(p \concat p' \concat \vec{p})}{\sigma'}{\beta}
}
{
   \untotalise{\elimList{\branchNil{\annot{\exNil}{\alpha}}}{\branchCons{\sigma}}}
              {(\pattCons{p}{p'} \concat \vec{p})}
              {\elimCons{\sigma'}}
              {\alpha \join \beta}
}
%
\and
%
\inferrule*[
   lab={\ruleName{non-empty list}}
]
{
   \untotalise{\sigma}{(p \concat o \concat \vec{p})}{\sigma'}{\beta}
}
{
   \untotalise{\elimList{\branchNil{\annot{\exNil}{\alpha}}}{\branchCons{\sigma}}}
              {(\pattList{p}{o} \concat \vec{p})}
              {\elimCons{\sigma'}}
              {\alpha \join \beta}
}
%
\and
%
\inferrule*[
   lab={\ruleName{list-rest-end}}
]
{
   \untotalise{\kappa}{\vec{p}}{\kappa'}{\beta}
}
{
   \untotalise{\elimList{\branchNil{\kappa}}{\branchCons{\elimVar{x}{\elimVar{y}{\annot{\exNil}{\alpha}}}}}}
              {(\pattSNil \concat \vec{p})}
              {\elimNil{\kappa'}}
              {\alpha \join \beta}
}
%
\and
%
\inferrule*[
   lab={\ruleName{list-rest-cons}}
]
{
   \untotalise{\sigma}{(p \concat o \concat \vec{p})}{\sigma'}{\beta}
}
{
   \untotalise{\elimList{\branchNil{\annot{\exNil}{\alpha}}}{\branchCons{\sigma}}}
              {(\pattSCons{p}{o} \concat \vec{p})}
              {\elimCons{\sigma'}}
              {\alpha \join \beta}
}
\end{smathpar}
\caption{Totalise -- backward slicing}
\end{figure}
