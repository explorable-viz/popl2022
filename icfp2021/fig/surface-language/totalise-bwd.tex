\begin{figure}[H]
\flushleft \shadebox{$\untotalise{\kappa}{\pi}{\kappa'}$}
\begin{smathpar}
\inferrule*[
   lab={\ruleName{empty}}
]
{
   \strut
}
{
   \untotalise{\kappa}{\seqEmpty}{\kappa}
}
\and
%
\inferrule*[
   lab={\ruleName{var}}
]
{
   \untotalise{\kappa}{\vec{p}}{\kappa'}
}
{
   \untotalise{\elimVar{x}{\kappa}}{(x \cdot \vec{p})}{\elimVar{x}{\kappa'}}
}
%
\and
%
\inferrule*[
   lab={\ruleName{true}}
]
{
   \untotalise{\kappa_1}{\vec{p}}{\kappa_1'}
}
{
   \untotalise{\elimBool{\kappa_1}{\kappa_2}}{(\pattTrue \cdot \vec{p})}{\elimBoolTrue{\kappa_1'}}
}
%
\and
%
\inferrule*[
   lab={\ruleName{false}}
]
{
   \untotalise{\kappa_2}{\vec{p}}{\kappa_2'}
}
{
   \untotalise{\elimBool{\kappa_1}{\kappa_2}}{(\pattFalse \cdot \vec{p})}{\elimBoolFalse{\kappa_2'}}
}
%
\and
%
\inferrule*[
   lab={\ruleName{prod}}
]
{
   \untotalise{\sigma}{(p \cdot p' \cdot \vec{p})}{\sigma'}
}
{
   \untotalise{(\elimProd{\sigma})}{(\pattPair{p}{p'} \cdot \vec{p})}{(\elimProd{\sigma'})}
}
%
\and
%
\inferrule*[
   lab={\ruleName{nil}}
]
{
   \untotalise{\kappa}{\vec{p}}{\kappa'}
}
{
   \untotalise{\elimList{\branchNil{\kappa}}{\branchCons{\sigma}}}{(\pattNil \cdot \vec{p})}{\elimNil{\kappa'}}
}
%
\and
%
\inferrule*[
   lab={\ruleName{cons}}
]
{
   \untotalise{\sigma}{(p \cdot p' \cdot \vec{p})}{\sigma'}
}
{
   \untotalise{\elimList{\branchNil{\kappa}}{\branchCons{\sigma}}}{(\pattCons{p}{p'} \cdot \vec{p})}{\elimCons{\sigma'}}
}
%
\and
%
\inferrule*[
   lab={\ruleName{non-empty list}}
]
{
   \untotalise{\sigma}{(p \cdot o \cdot \vec{p})}{\sigma'}
}
{
   \untotalise{\elimList{\branchNil{\kappa}}{\branchCons{\sigma}}}{(\pattList{p}{o} \cdot \vec{p})}{\elimCons{\sigma'}}
}
%
\and
%
\inferrule*[
   lab={\ruleName{list rest (end)}}
]
{
   \untotalise{\kappa}{\vec{p}}{\kappa'}
}
{
   \untotalise{\elimList{\branchNil{\kappa}}{\branchCons{\sigma}}}{(\pattSNil \cdot \vec{p})}{\elimNil{\kappa'}}
}
%
\and
%
\inferrule*[
   lab={\ruleName{list rest (cons)}}
]
{
   \untotalise{\sigma}{(p \cdot o \cdot \vec{p})}{\sigma'}
}
{
   \untotalise{\elimList{\branchNil{\kappa}}{\branchCons{\sigma}}}{(\pattSCons{p}{o} \cdot \vec{p})}{\elimCons{\sigma'}}
}
\end{smathpar}
\caption{Totalise -- backward slicing}
\end{figure}
