\begin{figure}[H]
\flushleft\shadebox{$\sigma, \vec{p} \dbwdarrow e$}
\begin{smathpar}
\inferrule*[
   lab={\ruleName{$\dbwdarrow$-pattern-seq}}
]
{
   \sigma, p \dbwdarrow\geq \exLambda{\sigma'}
   \\
   \sigma', \vec{p} \dbwdarrow e
}
{
   \sigma, p \cdot \vec{p}
   \dbwdarrow
   e
}
\end{smathpar}

\vspace{5pt}
\flushleft\shadebox{$\sigma, p \dbwdarrow \kappa$}
\begin{smathpar}
\inferrule*[
   lab={\ruleName{$\dbwdarrow$-var}}
]
{
   \sigma \geq \elimVar{x}{\kappa}
}
{
   \sigma, x
   \dbwdarrow
   \kappa
}
%
\and
%
\inferrule*[
   lab={\ruleName{$\dbwdarrow$-nil}}
]
{
   \sigma \geq \elimList{\kappa}{\sigma}
}
{
   \sigma, \exNil
   \dbwdarrow
   \kappa
}
%
\and
%
\inferrule*[
   lab={\ruleName{$\dbwdarrow$-cons}}
]
{
   \sigma \geq \elimList{\kappa}{\sigma'}
   \\
   \sigma', p \dbwdarrow \tau
   \\
   \tau, p' \dbwdarrow \kappa'
}
{
   \sigma, \pattCons{p}{p'}
   \dbwdarrow
   \kappa'
}
%
\and
%
\inferrule*[
   lab={\ruleName{$\dbwdarrow$-non-empty-list}}
]
{
   \sigma \geq \elimList{\kappa}{\sigma'}
   \\
   \sigma', p \dbwdarrow \tau
   \\
   \tau, o \dbwdarrow \kappa'
}
{
   \sigma, \pattList{p}{o}
   \dbwdarrow
   \kappa'
}
%
\and
%
\inferrule*[
   lab={\ruleName{$\dbwdarrow$-pair}}
]
{
   \sigma \geq \elimProd{\sigma'}
   \\
   \sigma', p \dbwdarrow \tau
   \\
   \tau, p' \dbwdarrow \kappa
}
{
   \sigma, \pattPair{p}{p'}
   \dbwdarrow
   \kappa
}
\end{smathpar}

\vspace{5pt}
\flushleft\shadebox{$\sigma, o \dbwdarrow \kappa$}
\begin{smathpar}
\inferrule*[
   lab={\ruleName{$\dbwdarrow$-$\hole$}}
]
{
   o \dbwdhole \sigma
   \\
   \sigma, o \dbwdarrow \kappa
}
{
   \hole, o
   \dbwdarrow
   \kappa
}
%
\and
%
\inferrule*[
   lab={\ruleName{$\dbwdarrow$-list-end}}
]
{
   \strut
}
{
   \elimList{\kappa}{\sigma}, \pattListEnd
   \dbwdarrow
   \kappa
}
%
\and
%
\inferrule*[
   lab={\ruleName{$\dbwdarrow$-list-rest}}
]
{
   \sigma, p \dbwdarrow \sigma'
   \\
   \sigma', o \dbwdarrow \kappa'
}
{
   \elimList{\kappa}{\sigma}, \pattListNext{p}{o}
   \dbwdarrow
   \kappa'
}
\end{smathpar}

\vspace{5pt}
\begin{minipage}[t]{0.5\textwidth}
\flushleft \shadebox{$p \dbwdhole \sigma$}
\begin{salign}
   \pattVar{x}
   &\dbwdhole
   \elimVar{x}{\hole}
   \\
   \pattTrue
   &\dbwdhole
   \elimBool{\hole}{\hole}
   \\
   \pattFalse
   &\dbwdhole
   \elimBool{\hole}{\hole}
   \\
   \pattPair{p}{p'}
   &\dbwdhole
   \elimList{\hole}{\hole}
   \\
   \pattNil
   &\dbwdhole
   \elimList{\hole}{\hole}
   \\
   \pattCons{p}{p'}
   &\dbwdhole
   \elimList{\hole}{\hole}
   \\
   \pattList{p}{o}
   &\dbwdhole
   \elimList{\hole}{\hole}
\end{salign}
\end{minipage}%
\begin{minipage}[t]{0.5\textwidth}
\flushleft \shadebox{$o \dbwdhole \sigma$}
\begin{salign}
   \pattListEnd
   &\dbwdhole
   \elimList{\hole}{\hole}
   \\
   \pattListNext{p}{o}
   &\dbwdhole
   \elimList{\hole}{\hole}
\end{salign}
\end{minipage}

\vspace{5pt}
\flushleft\shadebox{$\sigma, \vec{c} \dbwdarrow \vec{c}$}
\begin{smathpar}
\inferrule*[
   lab={\ruleName{$\dbwdarrow$-clause}}
]
{
   \sigma, \vec{p} \dbwdarrow e
   \\
   e, s \dbwdarrow s'
}
{
   \sigma, \clause{p}{s}
   \dbwdarrow
   \clause{p}{s'}
}
%
\and
%
\inferrule*[
   lab={\ruleName{$\dbwdarrow$-clause-seq}}
]
{
   \sigma, c \dbwdarrow c'
   \\
   \sigma, \vec{c} \dbwdarrow \vec{c}'
}
{
   \sigma, c \cdot \vec{c}
   \dbwdarrow
   c' \cdot \vec{c}'
}
\end{smathpar}
\caption{Desugaring clauses and patterns -- backward slicing, with hole expansion rules}
\end{figure}
