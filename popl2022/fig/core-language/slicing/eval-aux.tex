\begin{figure}[H]

\flushleft \shadebox{$\envLookupBwd{\rho}{\Gamma}{\bind{x}{v}}$}
\begin{smathpar}
   \inferrule*[
      lab={\ruleName{$\smalltriangleleft$-head}}
   ]
   {
      \strut
   }
   {
      \envLookupBwd{\hole_{\Gamma} \concat \bind{x}{u}}{\Gamma \concat \bind{x}{A}}{\bind{x}{u}}
   }
   %
   \and
   %
   \inferrule*[
      lab={\ruleName{$\smalltriangleleft$-tail}},
      right={$z \neq z'$}
   ]
   {
      \envLookupBwd{\rho}{\Gamma}{\bind{z}{v}}
   }
   {
      \envLookupBwd{\rho \concat \bind{z'}{\hole}}{\Gamma \concat \bind{z'}{A}}{\bind{z}{v}}
   }
\end{smathpar}

\vspace{5pt}
\flushleft\shadebox{$\rho \closeDefsBwdR \rho', h$}
\begin{salign}
   \vec{\bind{x}{v}}
   &\closeDefsBwdR
   (\bigjoin\vec{\rho}, \vec{\bind{x}{\sigma}} \join {\bigjoin\vec{h}})
   &
   \text{ where }
   v_i = \exClosure{\rho_i}{h_i}{\sigma_i}
\end{salign}

\small
$\begin{array}{lll|llll}
\arrayrulecolor{lightgray}
&&&\textit{where}
\\
\rowcolor{verylightgray}
\envLookupGC{\rho,z} &::& \Below{\rho} \to \Below{v}
&\envLookup{\rho}{z}{v}
&&
\\
\envLookupFwdF{\rho \concat \bind{x}{v},x}(\rho' \concat \bind{x}{u},x) &=& u
\\
\envLookupFwdF{\rho \concat \bind{y}{v},x}(\rho' \concat \bind{y}{u},x)
&=&
\envLookupFwdF{\rho,x}(\rho',x)
&
x \neq y
\\[3mm]
\envLookupBwdF{\rho \concat \bind{x}{v},x}(u)
&=&
\sub{\hole}{\rho} \concat \bind{x}{u}
\\
\envLookupBwdF{\rho \concat \bind{y}{v},x}(u)
&=&
\envLookupBwdF{\rho}(u) \concat \bind{y}{\hole}
&
x \neq y
\end{array}$
\caption{Auxiliary functions: forward and backward slicing}
\label{fig:slicing:eval-aux}
\end{figure}
