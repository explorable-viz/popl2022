\begin{figure}
\small
$\begin{array}{lll|lll}
   \arrayrulecolor{lightgray}
   &&&\textit{where}
   \\
   \rowcolor{verylightgray}
   \matchFwdF{w} &::& \Below{(v,\sigma)} \to \Below{(\rho,\kappa, \alpha)}
   &w &::& v, \sigma \matchR \rho, \kappa, \alpha
   \\
   \matchFwdF{w}(v,\sigma)
   &=&
   \matchFwdF{w}(u,\sigma')
   &
   (v,\sigma) \eq (u,\sigma')
   \\
   \matchFwdF{x}(v, \elimVar{x}{\kappa})
   &=&
   (\bind{x}{v}, \kappa, \TT)
   \\
   \matchFwdF{\matchTrue}(\annTrue{\alpha}, \elimBool{\kappa}{\kappa'})
   &=&
   (\seqEmpty, \kappa, \alpha)
   \\
   \matchFwdF{\matchFalse}(\annFalse{\alpha}, \elimBool{\kappa}{\kappa'})
   &=&
   (\seqEmpty, \kappa', \alpha)
   \\
   \matchFwdF{\matchRec{\vec{\bind{x}{w}} \concat \bind{y}{w'}}}
             (v', \elimRec{\vec{x} \concat y}{\sigma})
   &=&
   (\rho \concat \rho', \kappa, \alpha \meet \beta \meet \beta')
   &
   v' &=& \annRec{\vec{\bind{x}{v}} \concat \bind{y}{u}}{\alpha}
   \\
   &&&
   \tau &=& \elimRec{\vec{x}}{\sigma}
   \\
   &&&
   (\rho, \sigma', \beta)
   &=&
   \matchFwdF{\matchRec{\vec{\bind{x}{w}}}}(\annRec{\vec{\bind{x}{v}}}{\FF}, \tau)
   \\
   &&&
   (\rho', \kappa, \beta') &=& \matchFwdF{w}(u, \sigma')
   \\
   \matchFwdF{\matchNil}(\annNil{\alpha}, \elimList{\kappa}{\sigma'})
   &=&
   (\seqEmpty, \kappa, \alpha)
   \\
   \matchFwdF{\matchCons{w_1}{w_2}}(\annCons{v_1}{v_2}{\alpha}, \elimList{\kappa}{\sigma'})
   &=&
   (\rho_1 \concat \rho_2, \kappa, \alpha \meet \beta \meet \beta')
   &
   (\rho_1, \tau, \beta) &=& \matchFwdF{w_1}(v_1,\sigma')
   \\
   &&&
   (\rho_2, \kappa, \beta') &=& \matchFwdF{w_2}(v_2,\tau)
\end{array}$\\[3mm]

$\begin{array}{lll|lll}
   \arrayrulecolor{lightgray}
   \rowcolor{verylightgray}
   \matchBwdF{w} &::& \Below{(\rho,\kappa, \alpha)} \to \Below{(v,\sigma)}
   &w &::& v, \sigma \matchR \rho, \kappa, \alpha
   \\
   \matchBwdF{w}(\rho, \kappa, \alpha)
   &=&
   \matchBwdF{w}(\rho', \kappa', \alpha)
   &
   (\rho, \kappa) \eq (\rho', \kappa')
   \\
   \matchBwdF{\matchVar{x}}(\bind{x}{v}, \kappa, \alpha)
   &=&
   (v, \elimVar{x}{\kappa})
   \\
   \matchBwdF{\matchTrue}(\seqEmpty, \kappa, \alpha)
   &=&
   (\annTrue{\alpha}, \elimBool{\kappa}{\hole})
   \\
   \matchBwdF{\matchFalse}(\seqEmpty, \kappa, \alpha)
   &=&
   (\annFalse{\alpha}, \elimBool{\hole}{\kappa})
   \\
   \matchBwdF{\matchRec{\vec{\bind{x}{w}} \concat \bind{y}{w'}}}(\rho \concat \rho', \kappa, \alpha)
   &=&
   (\annRec{\vec{\bind{x}{v}} \concat \bind{y}{u}}{\alpha}, \elimRec{\vec{x} \concat y}{\tau})
   &
   (u,\sigma) &=& \matchBwdF{w'}(\rho', \kappa, \alpha)
   \\
   &&&
   (\annRec{\vec{\bind{x}{v}}}{\beta}, \tau) &=& \matchBwdF{\matchRec{\vec{\bind{x}{w}}}}(\rho, \sigma, \alpha)
   \\
   \matchBwdF{\matchNil}(\seqEmpty,\kappa,\alpha)
   &=&
   (\annNil{\alpha}, \elimList{\kappa}{\hole})
   \\
   \matchBwdF{\matchCons{w_1}{w_2}}(\rho_1 \concat \rho_2, \kappa, \alpha)
   &=&
   (\annCons{v_1}{v_2}{\alpha}, \elimList{\hole}{\tau})
   &
   (v_2, \sigma) &=& \matchBwdF{w_2}(\rho_2, \kappa, \alpha)
   \\
   &&&
   (v_1, \tau) &=& \matchBwdF{w_1}(\rho_1, \sigma, \alpha)
\end{array}$
\caption{Match: forward and backward dependency}
\end{figure}
