\begin{figure}[H]
\small
$\begin{array}{lll|llll}
\arrayrulecolor{lightgray}
&&&\textit{where}
\\
\rowcolor{verylightgray}
\evalBwdF{T} &::& \Below{v} \to \Below{(\rho,e,\TT)}
&T &::& \rho, e \eval v
\\
% hole
\evalBwdF{T}(\hole)
&=&
\evalBwdF{T}(v)
&
\hole \neq v &\eq& \hole
\\
% var
\evalBwdF{\trVar{x}{\rho}}(v)
&=&
(\rho',\exVar{x},\FF)
&
\rho' &=& \envLookupBwdF{\rho,x}(v)
\\
% op
\evalBwdF{\trOp{\primOp}{\rho}}(v)
&=&
(\rho',\exOp{\primOp},\FF)
&
\rho' &=& \envLookupBwdF{\rho,\primOp}(v)
\\
% fun
\evalBwdF{\trLambda{\sigma'}}(\exClosure{\rho}{\seqEmpty}{\sigma})
&=&
(\rho,\exLambda{\sigma},\FF)
\\
% int
\evalBwdF{\trInt{n}{\Gamma}}(\annInt{n}{\alpha})
&=&
(\hole_{\Gamma},\annInt{n}{\alpha},\alpha)
\\
% nil
\evalBwdF{\trNil{\Gamma}}(\annNil{\alpha})
&=&
(\hole_{\Gamma},\annNil{\alpha},\alpha)
\\
% cons
\evalBwdF{\trCons{T}{U}}(\annCons{v_1}{v_2}{\beta})
&=&
(\rho \join \rho', \annCons{e_1}{e_2}{\beta}, \beta^\twoPrime)
&
(\rho,e_1,\alpha) &=& \evalBwdF{T}(v_1)
\\
&&&
(\rho',e_2,\alpha') &=& \evalBwdF{U}(v_2)
\\
&&&
\beta^\twoPrime &=& \beta \join \alpha \join \alpha'
\\
% vector
\evalBwdF{\trVec{\vec{U}}{x}{T}{j}}(\annVecVal{\vec{u}}{\annInt{j}{\beta}}{\alpha})
&=&
(\bigjoin\vec{\rho} \join \rho',
 e^\twoPrime,
 \beta^\twoPrime)
&
(\rho_{i} \concat \bind{x}{i_{\beta'_{i}}}, e_{i}, \alpha'_{i})
&=&
\evalBwdF{U_{i}}(u_{i})
\\
&&&
(\rho', e', \alpha^\twoPrime)
&=&
\smash{\evalBwdF{T}(\annInt{j}{\beta \join {\hspace{0.1em}{\oldbigjoin}\hspace{-0.15em}{\vec{\beta}'}}})}
\\
&&&
e^\twoPrime &=& \annVec{\bigjoin\vec{e}}{x}{e'}{\alpha}
\\
&&&
\beta^\twoPrime &=& \alpha \join {\bigjoin{\vec{\alpha}'}} \join \alpha^\twoPrime
\\
% vector-lookup
\evalBwdF{\trVecLookup{T}{j}{U}{i}}(v)
&=&
(\rho \join \rho', \exVecLookup{e_1}{e_2}, \alpha \join \alpha')
&
v' &=& \mapUpdate{\annVecVal{\vec{\hole}}{\annInt{j}{\FF}}{\FF}}{i}{v}
\\
&&&
(\rho,e_1,\alpha)
&=&
\evalBwdF{T}(v')
\\
&&&
(\rho', e_2, \alpha')
&=&
\evalBwdF{U}(\annInt{i}{\FF})
\\
% vector-len
\evalBwdF{\trVecLen{T}{j}}(\annInt{j}{\beta})
&=&
(\rho, \exVecLen{e}, \alpha)
&
(\rho,e,\alpha) &=& \evalBwdF{T}(\annVecVal{\vec{\hole}}{\annInt{j}{\beta}}{\FF})
\\
% apply-prim-unsat
\evalBwdF{\trAppPrim{T}{\phi}{\vec{n}}{U}{\exInt{m}}}(\exPrimOp{\phi}{\vec{u} \concat u'})
&=&
(\rho \join \rho', \exApp{e_1}{e_2}, \alpha \join \alpha')
&
(\rho,e_1,\alpha) &=& \evalBwdF{T}(\exPrimOp{\phi}{\vec{u}})
\\
&&&
(\rho',e_2,\alpha') &=& \evalBwdF{U}(u')
\\
% apply-prim-sat
\evalBwdF{\trAppPrim{T}{\phi}{\vec{n}}{U}{\exInt{m}}}(\annInt{n'}{\beta})
&=&
(\rho \join \rho', \exApp{e_1}{e_2}, \alpha \join \alpha')
&
\primBwd{\phi}{\vec{n} \concat m}(\annInt{n'}{\beta}) &=& \vec{u} \concat u'
\\
&&&
(\rho,e_1,\alpha) &=& \evalBwdF{T}(\exPrimOp{\phi}{\vec{u}})
\\
&&&
(\rho',e_2,\alpha') &=& \evalBwdF{U}(u')
\\
% apply
\evalBwdF{\trApp{T}{U}{\matchPlug{w}{T'}}}(v)
&=&
(\rho \join \rho', \exApp{e_1}{e_2}, \alpha \join \alpha')
&
(\rho_1 \concat \rho_2 \concat \rho_3, e, \beta) &=& \evalBwdF{T'}(v)
\\
&&&
(v', \sigma) &=& \matchBwdF{w}(\rho_3,e,\beta)
\\
&&&
(\rho,e_2,\alpha) &=& \evalBwdF{U}(v')
\\
&&&
(\rho_1', h) &=& \closeDefsBwdF{}(\rho_2)
\\
&&&
(\rho',e_1,\alpha') &=& \evalBwdF{T}(\exClosure{\rho_1 \join \rho_1'}{h}{\sigma})
\\
% let-rec
\evalBwdF{\trLetRecMutual{h}{T}}(v)
&=&
(\rho \join \rho',\exLetRecMutual{h'}{e},\alpha)
&
(\rho \concat \rho_1,e,\alpha) &=& \evalBwdF{T}(v){T}
\\
&&&
(\rho', h') &=& \closeDefsBwdF{}(\rho_1)
\end{array}$
\caption{Evaluation: backward slicing (Boolean and pair cases omitted)}
\label{fig:eval:bwd}
\end{figure}
